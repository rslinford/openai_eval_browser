<!DOCTYPE html>
<html lang="en-US">
<head>
    <title>Evals</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<h3>Evals</h3>
<form action="/evals" method="post" id="main_form">
<div class="flex">
    <label for="eval_name" class="nowrap">Eval Name</label>
    <select id="eval_name" name="eval_name" onchange="document.getElementById('main_form').submit()">
        {% for eval in evals %}
            <option value="{{ loop.index0 }}">{{ eval.name }}</option>
        {% endfor %}
    </select>
</div>
<script>
    // Preserve selected eval_name
    (function () {
        const select = document.getElementById("eval_name");
        select.selectedIndex = "{{ eval_name_index }}";
    })();
</script>
<div class="flex">
    <label for="sample">Samples: </label>
    <select id="sample" name="sample" onchange="document.getElementById('main_form').submit()" autofocus>
        {% for sample in samples %}
            <option value="{{ loop.index0 }}">{{ sample }}</option>
        {% endfor %}
    </select>
</div>
<script>
    // Preserve selected sample
    (function () {
        const select = document.getElementById("sample");
        select.selectedIndex = "{{ sample_index }}";
    })();
</script>
</form>
{% for message in sample['input'] %}
    <div class="flex">
        <input type="text" style="width: 80px; margin-right: 10px;" value="{{ message['role'] }}" readonly/>
        <textarea rows="1" cols="100" readonly>{{ message['content'] }}</textarea>
    </div>
{% endfor %}
<div class="flex">
    <input type="text" style="width: 80px; margin-right: 10px;" value="Ideal" readonly/>
    <textarea rows="1" cols="100" readonly>{{ sample['ideal'] }}</textarea>
</div>
<script>
    // Expand textareas to fit their content
    (function () {
        const textareas = document.getElementsByTagName("textarea");
        Array.from(textareas).forEach(function (textarea) {
            textarea.style.height = textarea.scrollHeight + 'px';
        });
    })();
</script>
</body>
</html>
